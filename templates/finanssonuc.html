<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ hisse }} | Pro Terminal</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;700&family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --bg: #05070a;
            --card: #0f121d;
            --accent: #6366f1;
            --success: #10b981;
            --danger: #f43f5e;
            --warning: #f59e0b;
            --text-main: #f8fafc;
            --text-dim: #94a3b8;
            --border: rgba(255, 255, 255, 0.1);
        }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
        }

        .terminal-container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .top-header {
            grid-column: span 3;
            background: linear-gradient(135deg, #0f121d 0%, #1e293b 100%);
            padding: 30px 40px;
            border-radius: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid var(--border);
            margin-bottom: 10px;
        }

        .symbol-box h1 { font-size: 56px; margin: 0; letter-spacing: -3px; font-weight: 800; line-height: 1; }

        .expert-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 12px;
            font-weight: 800;
            font-size: 14px;
            text-transform: uppercase;
            margin-top: 10px;
            border: 1px solid;
        }
        .advice-buy { background: rgba(16, 185, 129, 0.1); color: var(--success); border-color: var(--success); }
        .advice-hold { background: rgba(245, 158, 11, 0.1); color: var(--warning); border-color: var(--warning); }
        .advice-sell { background: rgba(244, 63, 94, 0.1); color: var(--danger); border-color: var(--danger); }
        .advice-none { background: rgba(148, 163, 184, 0.1); color: var(--text-dim); border-color: var(--text-dim); }

        .price-box { text-align: right; }
        .price-val { font-size: 56px; font-weight: 800; color: var(--success); font-family: 'JetBrains Mono'; }

        .score-banner {
            grid-column: span 3;
            background: rgba(255,255,255,0.03);
            border: 1px dashed var(--border);
            border-radius: 16px;
            padding: 15px;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .glass-card {
            background: var(--card);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        .card-title {
            font-size: 13px;
            font-weight: 800;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            padding-bottom: 10px;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255,255,255,0.03);
        }

        .label { color: var(--text-dim); font-size: 13px; font-weight: 500; }
        .value { font-family: 'JetBrains Mono'; font-weight: 700; font-size: 16px; }

        .full-width-card { grid-column: span 3; }

        .ema-table { width: 100%; border-collapse: collapse; margin-top: 10px; }

        .ema-table th {
            text-align: left;
            color: var(--text-dim);
            font-size: 12px;
            padding: 10px;
            border-bottom: 1px solid var(--border);
        }

        .ema-table td {
            padding: 12px 10px;
            border-bottom: 1px solid rgba(255,255,255,0.02);
            font-family: 'JetBrains Mono';
        }

        .badge-signal {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 800;
        }

        .bg-success-soft { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .bg-danger-soft { background: rgba(244, 63, 94, 0.2); color: var(--danger); }
        .bg-warning-soft { background: rgba(245, 158, 11, 0.2); color: var(--warning); }

        .status-box {
            margin-top: 15px;
            padding: 12px;
            border-radius: 10px;
            font-size: 12px;
            line-height: 1.4;
            font-weight: 600;
        }
        .status-neutral { background: rgba(99, 102, 241, 0.1); border-left: 4px solid var(--accent); color: #cbd5e1; }
        .status-success { background: rgba(16, 185, 129, 0.1); border-left: 4px solid var(--success); color: #6ee7b7; }
        .status-danger { background: rgba(244, 63, 94, 0.1); border-left: 4px solid var(--danger); color: #fda4af; }
        .status-warning { background: rgba(245, 158, 11, 0.1); border-left: 4px solid var(--warning); color: #fcd34d; }

        .btn-new {
            grid-column: span 3;
            background: var(--accent);
            color: white;
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            text-decoration: none;
            font-weight: 800;
            margin-top: 20px;
            transition: 0.3s;
        }
        .btn-new:hover { opacity: 0.9; transform: translateY(-2px); }

        @media (max-width: 1100px) {
            .terminal-container { grid-template-columns: 1fr 1fr; }
            .top-header, .score-banner, .btn-new, .full-width-card { grid-column: span 2; }
        }
    </style>
</head>
<body>

    <div class="terminal-container">

        <header class="top-header">
            <div class="symbol-box">
                <span style="color: var(--accent); font-weight: 800; font-size: 12px; letter-spacing: 2px;">PRO TERMİNAL ANALİZİ</span>
                <h1>{{ long_name if long_name else hisse }}</h1>
                <div style="font-size: 14px; color: var(--text-dim); margin-top: 10px;">
                    <i class="fas fa-calendar-alt"></i> {{ tarih }} | <i class="fas fa-globe"></i> {{ web_site }}
                </div>
            </div>
            <div class="price-box">
                <span style="color: var(--text-dim); font-weight: 700; font-size: 14px;">GÜNCEL FİYAT</span>
                <div class="price-val">{{ "{:,.2f}".format(kapanıs) }}</div>

                <div class="expert-badge
                    {% if tavsiye == 'buy' or tavsiye == 'strong_buy' %}advice-buy
                    {% elif tavsiye == 'hold' %}advice-hold
                    {% elif tavsiye == 'sell' or tavsiye == 'underperform' %}advice-sell
                    {% else %}advice-none{% endif %}">
                    <i class="fas fa-user-tie"></i> UZMAN TAVSİYESİ: {{ tavsiye if tavsiye else 'VERİ YOK' }}
                </div>
            </div>
        </header>

        <div class="score-banner">
            <i class="fas fa-shield-alt" style="font-size: 24px; color: var(--{{ renk if renk != 'succes' else 'success' }});"></i>
            <span style="font-weight: 700; font-size: 18px;">GÜVEN ENDEKSİ:</span>
            <span style="font-weight: 800; font-size: 20px; color: var(--{{ renk if renk != 'succes' else 'success' }});">{{ güven_mesajı }}</span>
        </div>

        <div class="glass-card">
            <div class="card-title"><i class="fas fa-building"></i> Şirket Künyesi</div>
            <div class="data-row"><span class="label">Yönetici (CEO)</span><span class="value">{{ ceo if ceo else 'N/A' }}</span></div>
            <div class="data-row"><span class="label">Kuruluş Yılı</span><span class="value">{{ kuruluş_yılı }}</span></div>
            <div class="data-row"><span class="label">H.Arz Tarihi</span><span class="value">{{ halka_arz_tarihi }}</span></div>
            <div class="data-row"><span class="label">H.Arz Fiyatı</span><span class="value">{{ "{:,.2f}".format(halka_arz_fiyatı) if halka_arz_fiyatı else 'N/A' }}</span></div>
            <div class="data-row"><span class="label">Toplam Çalışan</span><span class="value">{{ "{:,.0f}".format(çalışan_sayısı) if çalışan_sayısı else 'N/A' }}</span></div>
            <div class="status-box status-neutral">
                <i class="fas fa-map-marker-alt"></i> {{ adres if adres else 'Merkez Bilgisi Yok' }}
            </div>
        </div>

        <div class="glass-card">
            <div class="card-title"><i class="fas fa-chart-line"></i> Teknik Göstergeler</div>
            <div class="data-row"><span class="label">ATH Zirve</span><span class="value" style="color: var(--warning);">{{ "{:,.2f}".format(ath) }}</span></div>
            <div class="data-row"><span class="label">Zirveden Uzaklık</span><span class="value" style="color: var(--danger);">%{{ "%.2f"|format(zirveden_uzaklık) }}</span></div>
            <div class="data-row"><span class="label">Hacim</span><span class="value">{{ "{:,.0f}".format(hacim) if hacim else 'N/A' }}</span></div>
            <div class="data-row"><span class="label">Beta (Volatilite)</span><span class="value">{{ beta if beta else 'N/A' }}</span></div>
            <div class="status-box status-neutral" style="border-left-color: var(--warning);">
                <i class="fas fa-wave-square"></i> PİYASA İŞTAHI: {{ indikatör }}
            </div>
        </div>

        <div class="glass-card">
            <div class="card-title"><i class="fas fa-percentage"></i> Değerleme & Çarpanlar</div>
            <div class="data-row"><span class="label">F/K Oranı</span><span class="value">{{ "%.2f"|format(fk) if fk else 'N/A' }}</span></div>
            <div class="data-row"><span class="label">PD/DD Oranı</span><span class="value">{{ defter_değeri }}</span></div>
            <div class="data-row"><span class="label">Özsermaye Karlılığı</span><span class="value" style="color: var(--success);">%{{ "%.2f"|format(oz_kaynak_karlılığı) if oz_kaynak_karlılığı else 'N/A' }}</span></div>
            <div class="data-row"><span class="label">PEG Rasyosu</span><span class="value">{{ peg_durum.split(' ')[0] if peg_durum else 'N/A' }}</span></div>
            <div class="status-box status-neutral">
                <i class="fas fa-info-circle"></i> {{ peg_durum }}
            </div>
        </div>

        <div class="glass-card">
            <div class="card-title"><i class="fas fa-heartbeat"></i> Finansal Sağlık</div>
            <div class="data-row"><span class="label">Cari Oran</span><span class="value">{{ cari_oran }}</span></div>
            <div class="data-row"><span class="label">Borç / Özkaynak</span><span class="value">{{ borç_bölü_özkaynak_oran }}</span></div>
            <div class="data-row"><span class="label">Net Kar Marjı</span><span class="value">%{{ "%.2f"|format(net_kar_marjı * 100) if net_kar_marjı else 'N/A' }}</span></div>
            <div class="status-box {% if cari_oran and cari_oran < 1 %}status-danger{% else %}status-success{% endif %}">
                <i class="fas fa-file-invoice-dollar"></i> {{ cari_durum }}
            </div>
        </div>

        <div class="glass-card">
            <div class="card-title"><i class="fas fa-tint"></i> Likidite & Baskı</div>
            <div class="data-row"><span class="label">Açığa Satış Oranı</span><span class="value">{{ açığa_satış_durumu.split(' ')[0] if açığa_satış_durumu else 'N/A' }}</span></div>
            <div class="data-row"><span class="label">Kurumsal Sahiplik</span><span class="value">%{{ "%.2f"|format(kurumsal_sahiplik) if kurumsal_sahiplik else 'N/A' }}</span></div>
            <div class="status-box status-danger">
                <i class="fas fa-exclamation-triangle"></i> {{ açığa_satış_durumu }}
            </div>
            <div class="status-box status-warning">
                <i class="fas fa-user-secret"></i> {{ insider_mesajı }}
            </div>
        </div>

        <div class="glass-card">
            <div class="card-title"><i class="fas fa-bullseye"></i> Beklentiler & Bilanço</div>
            <div class="data-row"><span class="label">Hedef Fiyat</span><span class="value" style="color: var(--warning);">{{ "{:,.2f}".format(hedef_fiyat) if hedef_fiyat else 'N/A' }}</span></div>
            <div class="data-row"><span class="label">Potansiyel Getiri</span><span class="value" style="color: var(--success);">+ %{{ "%.2f"|format(potansiyel) if potansiyel else '0' }}</span></div>
            <div class="data-row"><span class="label">Gelecek Bilanço</span><span class="value" style="color: var(--accent);">{{ bilanço_tarihi }}</span></div>
            <div class="data-row"><span class="label">Beklenen HBK</span><span class="value">{{ bilanço_beklenti }}</span></div>
            <div class="data-row"><span class="label">Temettü Verimi</span><span class="value">%{{ "%.2f"|format(temettü_verim * 100) if temettü_verim else '0.00' }}</span></div>
            <div class="status-box status-neutral">
                Piyasa Değeri: {{ "{:,.0f}".format(market_cap) if market_cap else 'N/A' }}
            </div>
        </div>

        <div class="glass-card full-width-card">
            <div class="card-title">
                <i class="fas fa-microchip"></i> TEKNİK ANALİZ RADARI (EMA SİNYALLERİ)
            </div>
            <div style="overflow-x: auto;">
                <table class="ema-table">
                    <thead>
                        <tr>
                            <th>PERİYOT</th>
                            <th>EMA DEĞERİ</th>
                            <th>FİYAT KONUMU</th>
                            <th>SİNYAL</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in ema_listesi %}
                        <tr>
                            <td><span style="color: var(--accent); font-weight: 700;">{{ item.periyot }}</span></td>
                            <td>{{ "{:,.2f}".format(item.deger) }}</td>
                            <td>
                                {% if kapanıs > item.deger %}
                                <i class="fas fa-chevron-up" style="color: var(--success);"></i> Üzerinde
                                {% else %}
                                <i class="fas fa-chevron-down" style="color: var(--danger);"></i> Altında
                                {% endif %}
                            </td>
                            <td>
                                <span class="badge-signal
                                    {% if item.renk|lower == 'success' or item.renk|lower == 'succes' %}bg-success-soft
                                    {% elif item.renk|lower == 'danger' %}bg-danger-soft
                                    {% else %}bg-warning-soft{% endif %}">
                                    {{ item.sinyal }}
                                </span>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="status-box status-neutral" style="margin-top: 20px;">
                <i class="fas fa-info-circle"></i>
                <strong>Analiz Notu:</strong>
                Fiyatın en uzun vade olan EMA-200 ({{ ema_sözlük['EMA-200'] if ema_sözlük and 'EMA-200' in ema_sözlük else 'N/A' }}) üzerinde olması, ana trendin boğa piyasasında olduğunu gösterir.
            </div>
        </div>

        <a href="/" class="btn-new"><i class="fas fa-search"></i> YENİ SORGULAMA YAP</a>

    </div>

</body>
</html>
